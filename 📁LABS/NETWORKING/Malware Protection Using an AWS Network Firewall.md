### **Task 1: Confirm Reachability**

* Logged into **TestInstance** via Session Manager.
* Used `wget` to download two malware test files from wicar.org.
* Verified reachability and saw **200 OK** responses.
* Confirmed both files downloaded using `ls`.
* This proved the malicious URLs were accessible through the current firewall.
* Prepared to update network controls to block these sites.

---

### **Task 2: Inspect the Network Firewall**

* Opened **LabFirewall** in AWS Network Firewall.
* Reviewed firewall overview and opened **LabFirewallPolicy**.
* Edited stateless default actions to forward all packets to stateful rule groups.
* Ensured deeper inspection using the stateful engine.
* Stateless engine only inspects individual packets; stateful inspects full flows.
* Firewall now sends all traffic for detailed inspection.

---

### **Task 3: Create a Firewall Rule Group**

* Created a **stateful rule group** using Suricata rule format.
* Named it **StatefulRuleGroup** with capacity 100.
* Added two Suricata IPS rules that match and drop both malicious URLs.
* Rules look for the URI patterns `/data/js_crypto_miner.html` and `/data/java_jre17_exec.html`.
* IPS rules allow deep URL inspection and blocking.
* Saved and created the stateful rule group.

---

### **Task 4: Attach Rule Group to Firewall**

* Opened **LabFirewallPolicy** from the firewall.
* Added the **StatefulRuleGroup** under stateful rule groups.
* Saw confirmation banner that policy was updated successfully.
* Verified the rule group appears in the associated policy.
* The firewall now blocks both malicious URL paths.
* Network protection is now active.

---

### **Task 5: Validate the Solution**

* Logged back into **TestInstance** via Session Manager.
* Re-ran both `wget` commands; requests hung at "awaiting response".
* This confirmed the firewall successfully blocked access.
* Deleted test files using `rm` and verified using `ls`.
* No files remained, confirming cleanup.
* Network firewall now fully prevents users from accessing the malicious site.

---


